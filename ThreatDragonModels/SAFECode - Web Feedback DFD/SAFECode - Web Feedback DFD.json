{
  "version": "2.5.0",
  "summary": {
    "title": "SAFECode - Web Feedback DFD",
    "owner": "Liam Sales",
    "description": "Recreation of SAFECode \"Web-based User Feedback System\" Data Flow Diagram (DFD). Shows User/Browser interacting with Web Application, LDAP for authentication, and SQL Database for saved feedback. Threats mapped via STRIDE.",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 3,
        "title": "SAFECode STRIDE Threat Model",
        "diagramType": "STRIDE",
        "version": "2.5.0",
        "cells": [
          {
            "id": "browser",
            "shape": "actor",
            "position": { "x": 110, "y": 160 },
            "size": { "width": 112.5, "height": 60 },
            "attrs": { "text": { "text": "Browser Client" }, "body": { "stroke": "red", "strokeWidth": 2.5 } },
            "data": {
              "type": "tm.Actor",
              "name": "Browser Client",
              "threats": [
                {
                  "id": "t1",
                  "title": "Spoofing",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker may spoof user identity or session.",
                  "mitigation": "Use TLS/SSL, secure cookies, MFA.",
                  "modelType": "STRIDE",
                  "number": 1
                }
              ]
            }
          },
          {
            "id": "webapp",
            "shape": "actor",
            "position": { "x": 419, "y": 160 },
            "size": { "width": 112.5, "height": 60 },
            "attrs": { "text": { "text": "Web Application" }, "body": { "stroke": "#333333", "strokeWidth": 1.5 } },
            "data": {
              "type": "tm.Actor",
              "name": "Web Application",
              "threats": [
                {
                  "id": "t2",
                  "title": "Spoofing",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker may spoof requests/responses between client and server.",
                  "mitigation": "Session tokens, request validation.",
                  "modelType": "STRIDE",
                  "number": 2
                }
              ]
            }
          },
          {
            "id": "auth",
            "shape": "actor",
            "position": { "x": 419, "y": 15 },
            "size": { "width": 112.5, "height": 60 },
            "attrs": { "text": { "text": "Authorization Provider" }, "body": { "stroke": "red", "strokeWidth": 2.5 } },
            "data": {
              "type": "tm.Actor",
              "name": "Authorization Provider",
              "threats": [
                {
                  "id": "t3",
                  "title": "Elevation of Privilege",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "ElevationOfPrivilege",
                  "description": "A compromised account may gain higher privileges than intended.",
                  "mitigation": "Principle of least privilege, RBAC, strong session validation.",
                  "modelType": "STRIDE",
                  "number": 3
                }
              ]
            }
          },
          {
            "id": "ldap",
            "shape": "actor",
            "position": { "x": 754, "y": 15 },
            "size": { "width": 112.5, "height": 60 },
            "attrs": { "text": { "text": "LDAP" }, "body": { "stroke": "#333333", "strokeWidth": 1.5 } },
            "data": {
              "type": "tm.Actor",
              "name": "LDAP",
              "threats": [
                {
                  "id": "t4",
                  "title": "Tampering (SQL Injection Attack)",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "Attacker tampers with data using SQL injection in LDAP queries.",
                  "mitigation": "Input validation, parameterized queries, stored procedures.",
                  "modelType": "STRIDE",
                  "number": 4
                }
              ]
            }
          },
          {
            "id": "db",
            "shape": "store",
            "position": { "x": 750, "y": 160 },
            "size": { "width": 120, "height": 60 },
            "attrs": { "text": { "text": "SQL Database" }, "body": { "stroke": "red", "strokeWidth": 2.5 } },
            "data": {
              "type": "tm.Store",
              "name": "SQL Database",
              "threats": [
                {
                  "id": "t5",
                  "title": "Spoofing",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Attacker may spoof or alter database connections.",
                  "mitigation": "Use DB authentication, encrypted connections, firewall rules.",
                  "modelType": "STRIDE",
                  "number": 5
                }
              ]
            }
          },
          {
            "id": "flow1",
            "shape": "flow",
            "source": { "cell": "browser" },
            "target": { "cell": "webapp" },
            "attrs": { "line": { "stroke": "#333333", "targetMarker": { "name": "block" } } },
            "data": { "type": "tm.Flow", "name": "User sends credentials" }
          },
          {
            "id": "flow2",
            "shape": "flow",
            "source": { "cell": "webapp" },
            "target": { "cell": "auth" },
            "data": { "type": "tm.Flow", "name": "Auth verification" }
          },
          {
            "id": "flow3",
            "shape": "flow",
            "source": { "cell": "auth" },
            "target": { "cell": "ldap" },
            "data": { "type": "tm.Flow", "name": "Verify privilege" }
          },
          {
            "id": "flow4",
            "shape": "flow",
            "source": { "cell": "webapp" },
            "target": { "cell": "db" },
            "data": { "type": "tm.Flow", "name": "Insert query with feedback comments" }
          }
        ]
      }
    ]
  }
}
